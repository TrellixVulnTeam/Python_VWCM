# -*- coding: utf-8 -*-
import pprint
from jose import jwt, jws, jwk

w ='''
{
  "jti": "a1e89f5a-e6da-4607-91c6-6e942fb28a08",
  "iat": 1540234520,
  "scope": [
    "READ",
    "WRITE"
  ],
  "user_id": "5bce1d11ad3ac600083d797e",
  "client_id": "5b391f6e02e9c10009af8592",
  "app_id": "5b391ec6f18f4f00082d59b1",
  "business_id": "5bce1d11ad3ac600083d797d",
  "service_id": "5b391f6df18f4f00082d59b3",
  "authorities": [
    "ROLE_BUSINESSADMIN",
    "ROLE_BUSINESS",
    "ROLE_CLI-AUTH-IDENTIFIED",
    "ROLE_CLI-1STPARTY",
    "ROLE_USER",
    "ROLE_AUTH-BASIC",
    "ROLE_CLI-3RDPARTY",
    "ROLE_PERSON",
    "ROLE_BUSINESSOWNER",
    "ROLE_BUSINESSUSER",
    "ROLE_AUTH-IDENTIFIED"
  ],
  "exp": 1540238120
}
'''
b = 'eyJhbGciOiJSUzUxMiJ9.eyJqdGkiOiJhMWU4OWY1YS1lNmRhLTQ2MDctOTFjNi02ZTk0MmZiMjhhMDgiLCJpYXQiOjE1NDAyMzQ1MjAsInNjb3BlIjpbIlJFQUQiLCJXUklURSJdLCJ1c2VyX2lkIjoiNWJjZTFkMTFhZDNhYzYwMDA4M2Q3OTdlIiwiY2xpZW50X2lkIjoiNWIzOTFmNmUwMmU5YzEwMDA5YWY4NTkyIiwiYXBwX2lkIjoiNWIzOTFlYzZmMThmNGYwMDA4MmQ1OWIxIiwiYnVzaW5lc3NfaWQiOiI1YmNlMWQxMWFkM2FjNjAwMDgzZDc5N2QiLCJzZXJ2aWNlX2lkIjoiNWIzOTFmNmRmMThmNGYwMDA4MmQ1OWIzIiwiYXV0aG9yaXRpZXMiOlsiUk9MRV9CVVNJTkVTU0FETUlOIiwiUk9MRV9CVVNJTkVTUyIsIlJPTEVfQ0xJLUFVVEgtSURFTlRJRklFRCIsIlJPTEVfQ0xJLTFTVFBBUlRZIiwiUk9MRV9VU0VSIiwiUk9MRV9BVVRILUJBU0lDIiwiUk9MRV9DTEktM1JEUEFSVFkiLCJST0xFX1BFUlNPTiIsIlJPTEVfQlVTSU5FU1NPV05FUiIsIlJPTEVfQlVTSU5FU1NVU0VSIiwiUk9MRV9BVVRILUlERU5USUZJRUQiXSwiZXhwIjoxNTQwMjM4MTIwfQ.DH_SwEWGuvHTtCP5glf1AncC3wflY6AfnKdfq5DmpS8ySKPVwkkNf9HDyNHc12vGkINVoOOZjuJOPnSM3WBiTrR4DcBtYrSmC2t2HnlLlUn60VXIvAN2V2GRW8otl19wDLOJUdjjzj9tl66tIbtL-ks5YkKqF2amEBbgnb1RPz9PrRFqzngICHAk28-ZaekYHiszhyvH1JVr-IqsZ3E6EmUfoSLXuFghFYtkqv3zfBvI4A-gTe9J0nf367cz4BxKrbVJJRtznII8aM_oRyBqeFq72o6Ghjhl_XwTXojy0fO_2t-i8_9IVgisBvJ8OHAJPD_ARxYuEFI7HrnqCWyc1g'

a1 = jwk.HMACKey.SHA512
a2 = jwt.calculate_at_hash(b, hash_alg=a1)
print(a2)

# a = jwt.encode('JWK',w, "JWT", algorithm='ALGORITHMS.HS256')
# print(w)


